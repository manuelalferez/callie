<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Friend Call Reminder</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  </head>
  <body class="bg-gray-100 min-h-screen p-8">
    <div id="app" class="max-w-6xl mx-auto">
      <div class="bg-white rounded-xl shadow-xl p-8">
        <h1 class="text-4xl font-bold mb-8 text-center text-indigo-700">
          Friend Call Reminder
        </h1>

        <!-- Add Friend Form -->
        <div class="mb-10 bg-indigo-50 p-6 rounded-lg">
          <h2 class="text-2xl font-semibold mb-6 text-indigo-600">
            Add New Friend
          </h2>

          <div class="mb-6">
            <label class="block text-lg font-medium text-gray-700 mb-2"
              >Friend's Name</label
            >
            <input
              type="text"
              v-model="newFriend.name"
              placeholder="Enter friend's name"
              class="mt-1 block w-full rounded-lg border-2 border-indigo-200 p-3 text-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
            />
          </div>

          <div class="mb-6">
            <label class="block text-lg font-medium text-gray-700 mb-2"
              >How often would you like to call them?</label
            >
            <div class="mt-3 space-x-6">
              <button
                @click="setCloseness(true)"
                :class="{'bg-indigo-600 text-white': newFriend.isClose, 'bg-white text-indigo-600 border-2 border-indigo-600': !newFriend.isClose}"
                class="px-6 py-3 rounded-lg text-lg font-medium transition-all duration-200 hover:transform hover:scale-105"
              >
                Close Friend (1-3 days)
              </button>
              <button
                @click="setCloseness(false)"
                :class="{'bg-indigo-600 text-white': !newFriend.isClose, 'bg-white text-indigo-600 border-2 border-indigo-600': newFriend.isClose}"
                class="px-6 py-3 rounded-lg text-lg font-medium transition-all duration-200 hover:transform hover:scale-105"
              >
                Regular Friend (3-7 days)
              </button>
            </div>
          </div>

          <button
            @click="addFriend"
            class="bg-indigo-600 text-white px-8 py-3 rounded-lg text-lg font-medium hover:bg-indigo-700 transition-colors duration-200 w-full md:w-auto"
          >
            Add Friend to List
          </button>
        </div>

        <!-- Friends List -->
        <div>
          <h2 class="text-2xl font-semibold mb-6 text-indigo-700">
            Your Friends to Call
          </h2>
          <div class="space-y-6">
            <div
              v-for="friend in friends"
              :key="friend.id"
              class="bg-white p-6 rounded-lg shadow-md border-2 border-gray-100 hover:border-indigo-200 transition-all duration-200"
            >
              <div class="flex justify-between items-center">
                <div class="space-y-2">
                  <h3 class="text-xl font-semibold text-gray-800">
                    {{ friend.name }}
                  </h3>
                  <p class="text-lg text-indigo-600 font-medium">
                    {{ friend.isClose ? 'üë• Close Friend' : 'üë§ Regular Friend'
                    }}
                  </p>
                  <p class="text-lg text-gray-600">
                    üìÖ Next Call: {{ formatDate(friend.nextCallDate) }}
                  </p>
                  <p
                    class="text-lg font-medium"
                    :class="getTimeLeftColor(friend.nextCallDate)"
                  >
                    ‚è∞ {{ getTimeLeft(friend.nextCallDate) }}
                  </p>
                </div>
                <button
                  @click="removeFriend(friend.id)"
                  class="text-red-600 hover:text-red-800 text-lg font-medium px-4 py-2 rounded-lg hover:bg-red-50 transition-colors duration-200"
                >
                  Remove Friend
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const { createApp } = Vue;

      createApp({
        data() {
          return {
            newFriend: {
              name: "",
              isClose: true,
            },
            friends: [],
            timer: null,
          };
        },
        methods: {
          setCloseness(isClose) {
            this.newFriend.isClose = isClose;
          },
          addFriend() {
            if (!this.newFriend.name) return;

            const today = new Date();
            const daysToAdd = this.newFriend.isClose
              ? Math.floor(Math.random() * 3) + 1 // 1-3 days
              : Math.floor(Math.random() * 5) + 3; // 3-7 days

            const nextCall = new Date(today);
            nextCall.setDate(nextCall.getDate() + daysToAdd);

            this.friends.push({
              id: Date.now(),
              name: this.newFriend.name,
              isClose: this.newFriend.isClose,
              nextCallDate: nextCall.toISOString(),
            });

            // Reset form
            this.newFriend.name = "";
            this.newFriend.isClose = true;

            // Save to localStorage
            this.saveFriends();
          },
          removeFriend(id) {
            this.friends = this.friends.filter((friend) => friend.id !== id);
            this.saveFriends();
          },
          saveFriends() {
            localStorage.setItem("friends", JSON.stringify(this.friends));
          },
          loadFriends() {
            const saved = localStorage.getItem("friends");
            if (saved) {
              this.friends = JSON.parse(saved);
            }
          },
          formatDate(dateString) {
            return new Date(dateString).toLocaleDateString("en-US", {
              weekday: "long",
              year: "numeric",
              month: "long",
              day: "numeric",
            });
          },
          getTimeLeft(dateString) {
            const now = new Date();
            const callDate = new Date(dateString);
            const diff = callDate - now;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor(
              (diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
            );
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

            if (diff < 0) {
              return "Call overdue!";
            }

            return `Time left: ${days}d ${hours}h ${minutes}m`;
          },
          getTimeLeftColor(dateString) {
            const now = new Date();
            const callDate = new Date(dateString);
            const diff = callDate - now;

            if (diff < 0) {
              return "text-red-600 font-bold";
            } else if (diff < 24 * 60 * 60 * 1000) {
              // less than 24 hours
              return "text-yellow-600";
            }
            return "text-green-600";
          },
          updateCountdowns() {
            // Force a re-render of the countdown timers
            this.friends = [...this.friends];
          },
        },
        mounted() {
          this.loadFriends();
          // Update countdowns every minute
          this.timer = setInterval(this.updateCountdowns, 60000);
        },
        beforeUnmount() {
          if (this.timer) {
            clearInterval(this.timer);
          }
        },
      }).mount("#app");
    </script>
  </body>
</html>
